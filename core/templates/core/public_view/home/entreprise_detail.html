{% extends "core/public_view/base.html" %}

{% block content %}
    <div class="lg:max-w-7xl m-auto py-6 px-2 flex flex-col gap-4">
        <a href="{% url 'core:list_entreprise_public' %}" class="text-blue-600 hover:underline">&larr; Retour à la liste des entreprises</a>

        <div>
            <div class="lg:h-[650px] flex max-sm:flex-col gap-2 mx-auto shadow-md px-4 py-3 rounded-md ">
                <div class="lg:w-2/5 flex flex-col justify-center items-start">
                    <h1 class="text-4xl lg:text-6xl font-bold">{{ entreprise.name|upper }}</h1>
                    <div>
                        <p class="text-neutral-600 lg:mt-2 text-lg">{{ entreprise.city }}, {{ entreprise.country }}</p>
                        <!-- <p class="text-neutral-600 mt-2">Secteur : {{ entreprise.sector }}</p> -->
                    </div>

                    <div class="pt-1 lg:pt-3 max-sm:hidden">
                        <p class="text-gray-600">{{entreprise.description|truncatewords:50}}</p>
                    </div>

                    <div class="pt-3 flex flex-col gap-2 max-sm:hidden">
                        <h3 class="font-semibold text-base">Contact</h3>
                        <div class="flex flex-wrap">
                            {% for contact in entreprise.contacts.all %}
                                <span class="px-4 py-1 rounded-md border mr-2 mb-2">{{ contact.phone }}</span>
                            {% endfor %}
                            
                        </div>
                    </div>

                </div>
                <div class=" relative lg:w-3/5 flex items-center justify-center max-h-[500px]">
                    {% for contenu in entreprise.contenus.all %}
                        {% if contenu.is_principal %}
                            <div class="
                                relative overflow-hidden object-cover
                                    
                                {% if contenu.ratio_string == '16/9' %}
                                aspect-[16/9]
                                {% elif contenu.ratio_string == '9/16' %}
                                aspect-[9/16]
                                
                                {% elif contenu.ratio_string == '4/3' %}
                                aspect-[4/3]
                                {% elif contenu.ratio_string == '3/4' %}
                                aspect-[3/4]

                                {% elif contenu.ratio_string == '1/1' %}
                                aspect-square
                                {% endif %}
                            
                            ">

                                {% with media_type=contenu.get_media_type %}
                                    {% if media_type == 'image' %}
                                        <img src="{{ contenu.file.url }}" alt="Image de l'entreprise {{ entreprise.name }}" class="rounded-md shadow-md object-cover 
                                        w-full h-full">
                                    {% elif media_type == 'video' %}
                                        <video controls class="rounded-md shadow-md w-full">
                                            <source src="{{ contenu.file.url }}">
                                        </video>
                                    {% endif %}
                                {% endwith %}
                            </div>
                        {% endif %}
                    {% endfor %}

                </div>

                <div class="md:hidden">
                    <div class="pt-1 lg:pt-3 ">
                        <p class="text-gray-600">{{entreprise.description|truncatewords:50}}</p>
                    </div>

                    <div class="pt-3 flex flex-col gap-2 ">
                        <h3 class="font-semibold text-base">Contact</h3>
                        <div class="flex flex-wrap">
                            {% for contact in entreprise.contacts.all %}
                                <span class="px-4 py-1 rounded-md border mr-2 mb-2">{{ contact.phone }}</span>
                            {% endfor %}
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="px-2 py-3 text-2xl font-semibold mt-4">
            <h2>Nos contenus</h2>

            <div id="contenu_list" class="grid grid-cols-1 md:grid-col-2 lg:grid-cols-4 gap-4">
                {% for contenu in entreprise.contenus.all %}
                    {% if contenu.is_principal == False %}
                    <div class="flex flex-col gap-1  rounded-md px-1 py-1">
                        <h3 class="text-base">{{ contenu.title }}</h3>
                        <div class="relative w-full overflow-hidden
                        
                        {% if contenu.ratio_string == '16/9' %}
                        aspect-[16/9]
                        {% elif contenu.ratio_string == '9/16' %}
                        aspect-[9/16]
                        
                        {% elif contenu.ratio_string == '4/3' %}
                        aspect-[4/3]
                        {% elif contenu.ratio_string == '3/4' %}
                        aspect-[3/4]

                        {% elif contenu.ratio_string == '1/1' %}
                        aspect-square
                        {% endif %}
                        ">
                        {% with media_type=contenu.get_media_type %}
                    
                                {% if media_type == 'image' %}
                                    <!-- Affichage Image -->
                                    <img src="{{ contenu.file.url }}" 
                                        class="w-full h-auto rounded-lg shadow-md object-cover" 
                                        alt="Illustration">

                                {% elif media_type == 'video' %}
                                    <!-- Affichage Vidéo avec le ratio dynamique vu précédemment -->
                                    <div class="aspect-video w-full bg-black rounded-lg overflow-hidden">
                                        <video controls class="w-full h-full object-cover">
                                            <source src="{{ contenu.file.url }}">
                                        </video>
                                    </div>
                                {% endif %}

                            {% endwith %}
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>


        <div class="px-2 py-3 text-2xl font-semibold mt-4">
            <h2>Nos Projects</h2>

            <div id="contenu_list" class="grid grid-cols-1 md:grid-col-2 lg:grid-cols-4 gap-4">
                {% for contenu in entreprise.projects.all %}
                    {% if contenu.is_principal == False %}
                    <div class="flex flex-col gap-1  rounded-md px-1 py-1">
                        <h3 class="text-base">{{ contenu.title }}</h3>
                        <div class="relative w-full overflow-hidden
                        
                        {% if contenu.ratio_string == '16/9' %}
                        aspect-[16/9]
                        {% elif contenu.ratio_string == '9/16' %}
                        aspect-[9/16]
                        
                        {% elif contenu.ratio_string == '4/3' %}
                        aspect-[4/3]
                        {% elif contenu.ratio_string == '3/4' %}
                        aspect-[3/4]

                        {% elif contenu.ratio_string == '1/1' %}
                        aspect-square
                        {% endif %}
                        ">
                        {% with media_type=contenu.get_media_type %}
                    
                                {% if media_type == 'image' %}
                                    <!-- Affichage Image -->
                                    <img src="{{ contenu.file.url }}" 
                                        class="w-full h-auto rounded-lg shadow-md object-cover" 
                                        alt="Illustration">

                                {% elif media_type == 'video' %}
                                    <!-- Affichage Vidéo avec le ratio dynamique vu précédemment -->
                                    <div class="aspect-video w-full bg-black rounded-lg overflow-hidden">
                                        <video controls class="w-full h-full object-cover">
                                            <source src="{{ contenu.file.url }}">
                                        </video>
                                    </div>
                                {% endif %}

                            {% endwith %}
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock content %}